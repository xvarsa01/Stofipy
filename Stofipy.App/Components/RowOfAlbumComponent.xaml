<?xml version="1.0" encoding="utf-8"?>

<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                             xmlns:converters="using:Stofipy.App.Converters"
                             x:Class="Stofipy.App.Components.RowOfAlbumComponent"
                             x:Name="Root">
    <ContentView.Resources>
        <converters:PlayOrPauseTextIconFromCurrentStateConverter x:Key="PlayOrPauseTextIconFromCurrentStateConverter" />
        <converters:IsPlayingToColorConverter x:Key="IsPlayingToColorConverter" />
    </ContentView.Resources>
    
    <Border x:Name="MainBorder"
            Style="{StaticResource LessRoundedComponent}">
        
        <Border.GestureRecognizers>
            <PointerGestureRecognizer
                PointerEntered="OnPointerEntered"
                PointerExited="OnPointerExited"/>
            <TapGestureRecognizer
                Command="{Binding TapCommand, Source={x:Reference Root}}"
                CommandParameter="{Binding CommandParameter, Source={x:Reference Root}}"/>
        </Border.GestureRecognizers>
        

        <Grid ColumnDefinitions="50, *, *, *, 50"
              ColumnSpacing="10"
              Padding="5">
            <Label Grid.Column="0"
                   x:Name="IndexLabel"
                   VerticalOptions="Center"
                   HorizontalOptions="End"
                   Text="{Binding IndexText , Source={x:Reference Root}}"
                   Style="{StaticResource TitleSmall}" />
            <Label Grid.Column="0"
                   x:Name="PlayPauseIconOveIndexLabel"
                   VerticalOptions="Center"
                   HorizontalOptions="End"
                   IsVisible="False"
                   Style="{StaticResource TitleSmall}">
                <Label.Text>
                    <MultiBinding Converter="{StaticResource PlayOrPauseTextIconFromCurrentStateConverter}">
                        <Binding Path="IsNowPlayingComponent" Source="{x:Reference Root}" />
                        <Binding Path="IsPlaying" Source="{x:Reference Root}" />
                    </MultiBinding>
                </Label.Text>
            </Label>
            
            <Grid
                Grid.Column="1"
                RowDefinitions="*, *">
                <Label
                    Grid.Row="0"
                    VerticalOptions="Center"
                    HorizontalOptions="Start"
                    Text="{Binding TopText, Source={x:Reference Root}}"
                    TextColor="{Binding Source={x:Reference Root}, Path=IsNowPlayingComponent, Converter={StaticResource IsPlayingToColorConverter}}"
                    Style="{StaticResource TitleSmall}"/>
                <Label Grid.Row="1"
                       VerticalOptions="Center"
                       HorizontalOptions="Start"
                       Text="{Binding BottomText, Source={x:Reference Root}}"
                       TextColor="{StaticResource TextDarkerWhite}"
                       Style="{StaticResource OpenAuthorDetailLink}">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding Source={x:Reference Root}, Path=BottomTextTapCommand}"
                                              CommandParameter="{Binding CommandParameter, Source={x:Reference Root}}"/>
                    </Label.GestureRecognizers>
                </Label>
            </Grid>
            
            <Label Grid.Column="2"
                   VerticalOptions="Center"
                   HorizontalOptions="Start"
                   Text="{Binding PlayCountText , Source={x:Reference Root}}"
                   Style="{StaticResource GeneralText}"/>
            
            <Label Grid.Column="3"
                   VerticalOptions="Center"
                   HorizontalOptions="End"
                   Text="{Binding DurationText , Source={x:Reference Root}}"
                   Style="{StaticResource GeneralText}"/>
            
            <Border Grid.Column="4"
                    x:Name="ShowMoreOptions"
                    Style="{StaticResource TransparentBorderThickness0}"
                    IsVisible="False"
                    VerticalOptions="Center">
        
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding DotsClickedCommand, Source={x:Reference Root}}"
                                          CommandParameter="{Binding CommandParameter, Source={x:Reference Root}}" />
                </Border.GestureRecognizers>
                <Image
                    Aspect="AspectFill"
                    HeightRequest="15"
                    WidthRequest="15"
                    Source="dots_3_white.png">
                </Image>
            </Border>
        </Grid>

    </Border>
</ContentView>